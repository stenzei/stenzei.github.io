<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="stenze" />

<meta name="date" content="2016-04-16" />

<title>Vectorizing Spatio-Temporal Models</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style/scholmd-heuristically-latest.min.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
  padding-left: 10px;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">stenze-R-pieces</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Blog</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mailto:s@skek.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/stenzei">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Vectorizing Spatio-Temporal Models</h1>
<h4 class="author"><em>stenze</em></h4>
<h4 class="date"><em>16 April 2016</em></h4>

</div>


<div id="basics" class="section level1">
<h1>Basics</h1>
<div id="modeling" class="section level2">
<h2>Modeling</h2>
<p>Among other fields, in machine learning vectorization is a common approach to reduce computation costs. Here I want to show how this approach can be applied to cellular automata. I am using Conway’s Game of Life as an example.</p>
<p>Cellar automata <a href="https://en.wikipedia.org/wiki/Cellular_automaton">see Wikipedia</a> are a widely used tool in modeling e.g. when it comes to the analysis of spatially explicit dynamics. The classical approach is to represent the 2-dimensional space as grid and iterate over it to calculate neighborhood dynamics grid cell by grid cell. The computational effort for this is <span class="math inline">\(O(n^3)\)</span> with <span class="math inline">\(n\)</span> representing the width of a square matrix, representing the landscape. However, when we deal with large landscapes computation costs grow strongly.</p>
</div>
<div id="rules" class="section level2">
<h2>Game of Life</h2>
<p>Conway’s Game of Life is a simple but yet interesting cellular automaton (for details see <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Wikipedia</a>). Implementations for a large number of programming languages can be found <a href="http://rosettacode.org/wiki/Conway%27s_Game_of_Life">here</a>.</p>
<p>The simple set of rules reads as follows:</p>
<ul>
<li>A cell can be dead or alive.</li>
<li>For each cell its eight neighbors are considered.</li>
<li>A dead cell turns into a living one, if it is surrounded by three living cells.</li>
<li>A living cell turns into a dead one, if it is surrounded by less then two living cells.</li>
<li>A living cell turns into a dead one, if it is surrounded by more then three living cells.</li>
<li>In all other situation the cell keeps its status.</li>
</ul>
</div>
</div>
<div id="vectorized-version" class="section level1">
<h1>Vectorized version</h1>
<p>In the following a vectorized version of the game is shown and explained using a 6 x 6 matrix representing the “landscape” where the game takes place.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,
                <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">6</span>))</code></pre></div>
<p>This is the initial state of of our cellular automaton. To calculate the subsequent one, we need to know the number of living neighbors around each cell. To achieve that, we just transform this matrix <span class="math inline">\(m\)</span> in a few steps. For the transformation we use another matrix <span class="math inline">\(t\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, 
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">6</span>))</code></pre></div>
<p>Multiplying matrix <span class="math inline">\(m\)</span> with <span class="math inline">\(t\)</span> yields the number of neighbors in a row.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>t %*%<span class="st"> </span>m</code></pre></div>
<p>The resulting matrix looks like that:</p>
<pre><code>0 0 0 0 0 0
0 1 1 1 0 0
0 2 2 2 0 0
0 3 3 3 0 0
0 2 2 2 0 0
0 1 1 1 0 0</code></pre>
<p>The numbers of neighbors in a column are calculated by swapping the factors of that matrix multiplication.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>m %*%<span class="st"> </span>t</code></pre></div>
<p>Now the resulting matrix reads:</p>
<pre><code>0 0 0 0 0 0
0 0 0 0 0 0
1 2 3 2 1 0
1 2 3 2 1 0
1 2 3 2 1 0
0 0 0 0 0 0</code></pre>
<p>Combining both operations yields the number of neighbors plus the focal cell itself.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>t %*%<span class="st"> </span>m %*%<span class="st"> </span>t</code></pre></div>
<pre><code>0 0 0 0 0 0
1 2 3 2 1 0
2 4 6 4 2 0
3 6 9 6 3 0
2 4 6 4 2 0
1 2 3 2 1 0</code></pre>
<p>To get only the number of neighboring cells for each cell without the cell itself we have to subtract the original matrix <span class="math inline">\(m\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>t %*%<span class="st"> </span>m %*%<span class="st"> </span>t -<span class="st"> </span>m</code></pre></div>
<pre><code>0 0 0 0 0 0
1 2 3 2 1 0
2 3 5 3 2 0
3 5 8 5 3 0
2 3 5 3 2 0
1 2 3 2 1 0</code></pre>
<p>Now, we have the number of neighbors of each cell. Based on this we can calculate the next states based on the <a href="#rules">rules described above</a>: First, we set all cells to zero that will not be alive in the next time step.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm[tm ==<span class="st"> </span><span class="dv">1</span>] =<span class="st"> </span><span class="dv">0</span>
tm[tm &gt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span></code></pre></div>
<pre><code>0 0 0 0 0 0
0 2 3 2 0 0
2 3 0 3 2 0
3 0 0 0 3 0
2 3 0 3 2 0
0 2 3 2 0 0</code></pre>
<p>Second, we are interested in all cells with three neighbors and living cells with two neighbors. By adding the original matrix <span class="math inline">\(m\)</span> to the matrix <span class="math inline">\(tm\)</span>, all living cells with two or tree neighbors get the value 3 or 4. Dead cells with three neighbors also get the value 3. All other cells get the values 0, 1 or 2. These will be dead in the next time step.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>tm +<span class="st"> </span>m</code></pre></div>
<pre><code>0 0 0 0 0 0
0 2 3 2 0 0
2 4 1 4 2 0
3 1 1 1 3 0
2 4 1 4 2 0
0 2 3 2 0 0</code></pre>
<p>Now, all dead cells are set to 0 and all other cells are set to 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm[tm &lt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span>
tm[tm &gt;<span class="st"> </span><span class="dv">0</span>] =<span class="st"> </span><span class="dv">1</span></code></pre></div>
<pre><code>0 0 0 0 0 0
0 0 1 0 0 0
0 1 0 1 0 0
1 0 0 0 1 0
0 1 0 1 0 0
0 0 1 0 0 0</code></pre>
<p>Thus the whole algorithm for one time step reads:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>t %*%<span class="st"> </span>m %*%<span class="st"> </span>t -<span class="st"> </span>m
tm[tm ==<span class="st"> </span><span class="dv">1</span>] =<span class="st"> </span><span class="dv">0</span>
tm[tm &gt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span>
tm &lt;-<span class="st"> </span>tm +<span class="st"> </span>m
tm[tm &lt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span>
tm[tm &gt;<span class="st"> </span><span class="dv">0</span>] =<span class="st"> </span><span class="dv">1</span>
m &lt;-<span class="st"> </span>tm</code></pre></div>
</div>
<div id="modifications" class="section level1">
<h1>Modifications</h1>
<div id="von-neumann-neighbourhood" class="section level2">
<h2>Von Neumann neighbourhood</h2>
<p>If we were only interested in the <strong>Von Neumann neighborhood</strong> (four neighbors are considered), the corresponding calculation of <span class="math inline">\(tm\)</span> in the first line would be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tm &lt;-<span class="st"> </span>t %*%<span class="st"> </span>m +<span class="st"> </span>m %*%<span class="st"> </span>t -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>m</code></pre></div>
<pre><code>0 0 0 0 0 0
0 1 1 1 0 0
1 2 3 2 1 0
1 3 4 3 1 0
1 2 3 2 1 0
0 1 1 1 0 0</code></pre>
</div>
<div id="torrodial-world" class="section level2">
<h2>Torrodial world</h2>
<p>If we want to model a torrodial world where the game of life takes place, we need to modify the transformation matrix <span class="math inline">\(t\)</span> (add ones in the lower left and upper right corners).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, 
                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, 
                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, 
                <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">6</span>))</code></pre></div>
</div>
</div>
<div id="r-code" class="section level1">
<h1>R code</h1>
<p>The whole algorithm for a 20 x 20 torrodial world reads:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Matrix)

<span class="co"># Constructing the matrix of the game.</span>
width &lt;-<span class="st"> </span><span class="dv">20</span>
<span class="co"># Filling m with 0&#39;s.</span>
m &lt;-<span class="st"> </span><span class="kw">Matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>, width *<span class="st"> </span>width), width, <span class="dt">sparse =</span> <span class="ot">TRUE</span>)

<span class="co"># Constructing a glider in the upper left corner.</span>
i &lt;-<span class="st"> </span><span class="dv">1</span>
j &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co"># Setting living cells of the glider.</span>
m[i +<span class="st"> </span><span class="dv">1</span>, j] &lt;-<span class="st"> </span><span class="dv">1</span>
m[i +<span class="st"> </span><span class="dv">2</span>, j +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
m[i, j +<span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
m[i +<span class="st"> </span><span class="dv">1</span>, j +<span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
m[i +<span class="st"> </span><span class="dv">2</span>, j +<span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span>

<span class="co"># Constructing the transformation matrix.</span>
tt &lt;-<span class="st"> </span><span class="kw">Diagonal</span>(width)
<span class="co"># Constructing the minor diagonals.</span>
md &lt;-<span class="st"> </span><span class="kw">Diagonal</span>(width -<span class="st"> </span><span class="dv">1</span>)
md &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dv">0</span>, <span class="kw">cbind</span>(md, <span class="dv">0</span>))
tt &lt;-<span class="st"> </span>tt +<span class="st"> </span>md +<span class="st"> </span><span class="kw">t</span>(md)
<span class="co"># Making it torrodial. </span>
tt[<span class="kw">c</span>(<span class="dv">1</span>,width),<span class="kw">c</span>(width,<span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="dv">1</span>
  
<span class="co"># Calculating the game for 10 time steps.</span>
for (i in <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">10</span>)) {
  tm &lt;-<span class="st"> </span>tt %*%<span class="st"> </span>m %*%<span class="st"> </span>tt -<span class="st"> </span>m
  tm[tm ==<span class="st"> </span><span class="dv">1</span>] =<span class="st"> </span><span class="dv">0</span>
  tm[tm &gt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span>
  tm &lt;-<span class="st"> </span>tm +<span class="st"> </span>m
  tm[tm &lt;<span class="st"> </span><span class="dv">3</span>] =<span class="st"> </span><span class="dv">0</span>
  tm[tm &gt;<span class="st"> </span><span class="dv">0</span>] =<span class="st"> </span><span class="dv">1</span>
  m &lt;-<span class="st"> </span>tm
}</code></pre></div>
<p>You can find all the code related with this post, including a shiny app and the script for comparing the performance of different implementations in parallel on <a href="https://github.com/stenzei/GameOfLive">github</a>.</p>
</div>
<div id="examples-to-play-with" class="section level1">
<h1>Examples to play with</h1>
<iframe src="https://stenze.shinyapps.io/app-game-of-life/" style="border:none" height="590" width="100%">
</iframe>
</div>
<div id="performance" class="section level1">
<h1>Performance</h1>
<p>This approach is most advantageous for sparse matrices. To show this, three implementations are compared:</p>
<ul>
<li><p>the straight forward implementations found on <a href="http://rosettacode.org/wiki/Conway%27s_Game_of_Life#R">rosettacode.org</a>,</p></li>
<li><p>a very fast implementation by petrkeil found on <a href="https://www.r-bloggers.com/fast-conways-game-of-life-in-r/">r-bloggers.com</a>,</p></li>
<li><p>the implementation described here named <em>matrices</em>.</p></li>
</ul>
<p>The violin plot below shows performances for a quite sparse matrix. For less sparse matrices petrkeil performs better than the matrix approach.</p>
<p>The square matrices for the performance test is generated as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Matrix)

m &lt;-<span class="st"> </span><span class="kw">Matrix</span>(<span class="dt">nrow =</span> side, <span class="dt">ncol =</span> side, <span class="dt">sparse =</span> <span class="ot">TRUE</span>)
m[] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(side^<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</code></pre></div>
<p><code>side</code> varies from 100 to 1000. For the rosetta implementation only matrices up to a side length of 300 grid cells are computed.</p>
<p><img src="GameOfLife_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>This example can be seen as proof of concept, that for quadratic grids using specialized algorithms for sparse matrix computation can be a fast alternative to classical approaches, which just use three nested for-loops. At least for the rule set of Conway’s game of life it is possible to use linear algebra methods for computing spatio-temporal dynamics. In principle this should be possible for other cellular automata as well (which has to be proven).</p>
<p>The advantage of this approach is that calculations of system dynamics can be done even faster by using optimized algorithms and efficient parallel computing strategies like map reduce, which is especially relevant when it comes to very large grids.</p>
</div>

<hr>
<p>Copyright &copy; 2016 stenze 
<a href="mailto:s@skek.de">
<i class="fa fa-envelope" aria-hidden="true"></i></a></p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
