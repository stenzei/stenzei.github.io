<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Sten Zeibig" />


<title>Building Shiny Dashboards</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">stenze-R-pieces</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Blog</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="http://github.com/stenzei">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Building Shiny Dashboards</h1>
<h4 class="author"><em>Sten Zeibig</em></h4>
<h4 class="date"><em>X 2017</em></h4>

</div>


<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="what-is-shiny-and-what-is-it-about" class="section level2">
<h2><span class="header-section-number">1.1</span> What is Shiny and what is it about?</h2>
<p>Shiny is a R package to allow to interact with plots, maps and tables to explore data. Especially dashboards are well suited to present data in an interactive way. There is a number of R packages related to Shiny, which make it relatively easy to develop dashboards by wrapping web technologies like HTML, CSS and JavaScript. This workshop introduces into developing dashboards with Shiny and related packages. Core concepts of shiny (e.g. reactiveness) as well as programming techniques like modularisation and debugging will be addressed.</p>
</div>
<div id="about-this-workshop" class="section level2">
<h2><span class="header-section-number">1.2</span> About this workshop</h2>
<p>The aim of this workshop is to give a head start for building shiny applications and especially dashboards. There is a lot of very good material available in the internet especially on the webpage of <a href="https://shiny.rstudio.com">RStudio</a>. We will use the documentation and tutorial there as main reference.</p>
<p>For plotting we use <a href="http://jkunst.com/highcharter/index.html">highcharter</a>, which is a R wrapper around the Java Script library Highcharts. This library respects the grammar of graphics, uses pipes and allows to demonstrate the usage of Java Script wrappers and their extension with Java Script in R. The usage of Highcharts is not free for commercial and governmental use, but we are allowed to use it for scientific and educational purposes.</p>
<p>At the end of this workshop you will have build a Shiny Dashboard an will know where and how to find help about Shiny and related technologies quickly.</p>
</div>
<div id="ressources" class="section level2">
<h2><span class="header-section-number">1.3</span> Ressources</h2>
<p>RStudio’s Shiny web page <a href="https://shiny.rstudio.com">shiny.rstudio.com</a> is your first choice. There is nothing better for self-study then the RStudio web page. There, you can find introductory tutorial videos, webinars and articles about advanced shiny programming.</p>
<p>Everything else we are going to use is mostly well documented. You will find links to tutorials and documentation pages throughout this script and an number of links at <a href="#links">the end</a> of this document.</p>
</div>
<div id="prerequisites" class="section level2">
<h2><span class="header-section-number">1.4</span> Prerequisites</h2>
<p>Requirements:</p>
<ul>
<li>Intermediate R programming skills</li>
<li>knowing how to use dplyr and pipes</li>
<li>having a rough understanding of the grammar of graphics would be advantageous.</li>
</ul>
<p>Needed software:</p>
<ul>
<li>R preferably 3.4.1 or later</li>
<li>RStudio (latest version is always best)</li>
<li>shiny 1.0.5 or later</li>
<li>shinydashboard 0.6.1 or later</li>
<li>flexdashboard 0.5 or later</li>
<li>tidyverse 1.1.1 or later</li>
<li>highcharter 0.5.0 or later</li>
<li>packrat 0.4.8 or later.</li>
</ul>
<p>This is for a start. It will be probably necessary to install further packages from the internet during the workshop.</p>
</div>
</div>
<div id="basic-shiny" class="section level1">
<h1><span class="header-section-number">2</span> Basic Shiny</h1>
<div id="first-example" class="section level2">
<h2><span class="header-section-number">2.1</span> First Example</h2>
<p>The following is a first example of a simple Shiny app, which displays some random numbers. The app allows to choose the number of random values. You do not have to understand all parts of the code right now. The details of the code will be discussed in the following sections.</p>
<pre class="r"><code>library(shiny)
library(highcharter)

# Define program logic inside the server function.
server &lt;- function(input, output) {
  # Define the output
  output$noise_plot &lt;- renderHighchart({
    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 3, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
    
    # Create the plot.
    highcharter::highchart() %&gt;% 
      highcharter::hc_xAxis(dta$num) %&gt;% 
      highcharter::hc_add_series(name = &quot;random data&quot;,
                                 data = dta$val)
  })
}

# Define the user interface inside the ui list.
ui &lt;- fluidPage(
  highcharter::highchartOutput(&quot;noise_plot&quot;),
  sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200)
)

# The shiny app is created here.
shinyApp(ui = ui, server = server, options = list(height = 550))</code></pre>
<div class="figure">
<img src="img/img1.png" />

</div>
</div>
<div id="basic-app-design" class="section level2">
<h2><span class="header-section-number">2.2</span> Basic App Design</h2>
<div id="app.r" class="section level3">
<h3><span class="header-section-number">2.2.1</span> app.R</h3>
<p>On the top level of your working directory lives the file app.R, which has the following structure:</p>
<pre class="r"><code>library(shiny)

# All the logic, data crunching, tidying, and wrangling goes here.
# (That is not always true, but it is the default case.)
# Technically server is a function.
server &lt;- function(input, output) {

}

# The user interface is defined here. Technically ui is a list.
ui &lt;- fluidPage(
  
)

# The shiny app is created here.
shinyApp(ui = ui, server = server)</code></pre>
</div>
<div id="server.r-and-ui.r" class="section level3">
<h3><span class="header-section-number">2.2.2</span> server.R and ui.R</h3>
<p>In larger projects <code>server</code> and <code>ui</code> live in separate files on the top level of your working directory.</p>
</div>
<div id="linking-inputs-and-outputs" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Linking Inputs and Outputs</h3>
<p>Inside the server function output elements are constructed and input elements are logically linked to them. Inside the ui list input and output elements are arranged.</p>
</div>
<div id="exercise" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Exercise</h3>
<blockquote>
<ol style="list-style-type: decimal">
<li>Create a working directory for your first app. Copy the code of the first example into your RStudio editor and save the file in your working directory. Run the app by typing <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/runApp.html"><code>runApp()</code></a> into the console or press the <em>Run App</em> button in the upper left corner.</li>
<li>Add two more sliders to the first example to allow users to adjust mean and standard deviation.</li>
</ol>
</blockquote>
</div>
</div>
<div id="layout-of-user-interfaces" class="section level2">
<h2><span class="header-section-number">2.3</span> Layout of user interfaces</h2>
<p>The <code>ui</code>-list is created by the function <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/fluidPage.html"><code>fluidPage()</code></a>. This function arranges interface elements and adjusts the layout to the browser, where your app runs. A simple layout may look like this:</p>
<pre class="r"><code>ui &lt;- fluidPage(
  titlePanel(&quot;title panel&quot;),
  
  sidebarLayout(
    sidebarPanel(&quot;this a sidebar panel&quot;),
    mainPanel(&quot;this is the main panel&quot;)  
)</code></pre>
<p>This is the framework for a simple straight forward user interface. See the reference pages of <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/titlePanel.html"><code>titlePanel()</code></a>, <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/sidebarLayout.html"><code>sidebarLayout()</code></a>, <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/sidebarPanel.html"><code>sidebarPanel()</code></a>, and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/mainPanel.html"><code>mainPanel()</code></a> for more details.</p>
<p>Inside the <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/sidebarLayout.html"><code>sidebarLayout()</code></a> and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/mainPanel.html"><code>mainPanel()</code></a> you can place your input and output elements as well as formatted text:</p>
<pre class="r"><code>ui &lt;- fluidPage(
  titlePanel(&quot;Random Numbers&quot;),
  
  sidebarPanel(
    h3(&quot;Controls&quot;),
    sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200),
    p(&quot;Use the slider input to choose the number of plotted random values.&quot;)
  ),
  
  mainPanel(
    h3(&quot;Plots &amp; Infos&quot;),  
    highcharter::highchartOutput(&quot;noise_plot&quot;),
    p(&quot;This a plot of random numbers.&quot;)
  )
)</code></pre>
<div class="figure">
<img src="img/img2.png" />

</div>
<p>This example shows the HTML builder functions <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/builder.html"><code>h3()</code></a> and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/builder.html"><code>p()</code></a>. These are basically wrappers around HTML tags. There is a lot more of these functions. More examples and details are given in the <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson2/">RStudio Shiny Tutorial</a>.</p>
</div>
<div id="controlls" class="section level2">
<h2><span class="header-section-number">2.4</span> Controlls</h2>
<p>In the example above we have already used the <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/sliderInput.html"><code>sliderInput()</code></a> to allow users to select specific values. The first parameter of <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/sliderInput.html"><code>sliderInput()</code></a> is its inputId. We access the value of the input by referencing this ID in the server via <code>input$inputId</code>.</p>
<p>There is a lot more to say about control widgets. An overview about this is given in Lesson 3 of the <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson3/">RStudio Shiny Tutorial</a>. In the following you see the usage of a few control widgets:</p>
<pre class="r"><code>ui &lt;- fluidPage(
  titlePanel(&quot;Random Numbers&quot;),
  sidebarPanel(
    h3(&quot;Controls&quot;),
    sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200),
    p(&quot;Use the slider input to choose the number of plotted random values.&quot;),
    numericInput(&quot;mean&quot;, h3(&quot;Mean&quot;), value = 0),
    numericInput(&quot;sd&quot;, h3(&quot;Standard Deviation&quot;), value = 1)
  ),
  mainPanel(
    h3(&quot;Plots &amp; Infos&quot;),  
    highcharter::highchartOutput(&quot;noise_plot&quot;),
    p(&quot;This is still a plot of random numbers.&quot;)
  )
)</code></pre>
<div class="figure">
<img src="img/img3.png" />

</div>
<div id="exercise-1" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Exercise</h3>
<blockquote>
<p>Extend your app so that it looks like the following. You might want to refer to <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/radioButtons.html"><code>radioButtons()</code></a> and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/numericInput.html"><code>numericInput()</code></a>.</p>
</blockquote>
<div class="figure">
<img src="img/img4.png" />

</div>
</div>
</div>
<div id="outputs" class="section level2">
<h2><span class="header-section-number">2.5</span> Outputs</h2>
<p>In the examples and exercises above we already used the <a href="http://jkunst.com/highcharter/shiny.html"><code>highchartOutput()</code></a>. This function displays plots generated with the <a href="http://jkunst.com/highcharter/index.html"><code>highcharter</code></a> package.</p>
<p>There are also many other output types already included in the <code>shiny</code> package. You can get an overview in Lesson 4 of the <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson4/">RStudio Shiny Tutorial</a>. Two of these outputs are demonstrated in the following example:</p>
<pre class="r"><code>server &lt;- function(input, output) {
  # Define the output
  output$noise_plot &lt;- renderPlot({
    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 0, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
    
    # Create the plot.
    plot(dta)
  })
  
  output$noise_table &lt;- renderDataTable({
    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 0, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
    
    # Return the table data.
    dta
  })
}

ui &lt;- fluidPage(
  sidebarPanel(
    sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200)
  ),
  
  mainPanel(
    plotOutput(&quot;noise_plot&quot;),
    dataTableOutput(&quot;noise_table&quot;)
  )
)
shinyApp(ui = ui, server = server, options = list(height = 800))</code></pre>
<div class="figure">
<img src="img/img5.png" />

</div>
<p>The outputs used here are the standard shiny <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/plotOutput.html">plot output</a> and the shiny <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/tableOutput.html">output for data tables</a>.</p>
<div id="exercise-2" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Exercise</h3>
<blockquote>
<ol style="list-style-type: decimal">
<li>Extend your app by <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/tableOutput.html"><code>dataTableOutput()</code></a> and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/renderDataTable.html"><code>renderDataTable()</code></a>.</li>
<li>Change your table (e.g. number of shown lines).</li>
<li>Change the layout of your app: You now want to display the plot and the table side by side. (Hint: <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/column.html"><code>column()</code></a> and <a href="https://shiny.rstudio.com/reference/shiny/1.0.5/fluidPage.html"><code>fluidRow()</code></a>)</li>
</ol>
</blockquote>
</div>
</div>
<div id="reactivity" class="section level2">
<h2><span class="header-section-number">2.6</span> Reactivity</h2>
<p>This is the core concept of shiny. Understanding this is crucial for writing correct and efficient code and, in the end, for being able to develop more complex apps like dashboards. The code of Shiny apps is not executed sequentially but on demand. Code parts react to what is happening in other code parts. This reactivity could be understood by a directed information propagation graph. In this graph information is propagated from root nodes to the leaves.</p>
<p>We used reactiveness implicitly in all the examples: <code>output$...</code> reacts to changes is <code>input$...</code>. A simple information propagation graph looks as follows:</p>
<div class="figure">
<img src="https://shiny.rstudio.com/images/reactivity_diagrams/simplest.png" alt="Simple information propagation graph (Source: RStudio)" />
<p class="caption">Simple information propagation graph (Source: <a href="https://shiny.rstudio.com/articles/reactivity-overview.html">RStudio</a>)</p>
</div>
<p>On the left there is some <code>input$...</code> element (called <em>reactive source</em>). On the right there is an <code>output$...</code> element (called <em>reactive endpoint</em>) reacting to changes in the input. This means the code for generating the output (e.g. a plot or a table) inside the server function is executed: Every time we move the slider input in our latest app the functions <code>renderPlot()</code> and <code>renderTable()</code> are re-executed.</p>
<p>This has the advantage, that code is only executed if it is necessary. What we also want is that we execute as little code as possible to update the output. Thus we want to avoid redundant code execution.</p>
<p>In out last example above, the <code>server()</code> code contains the following part twice (with different results!), in <code>renderPlot()</code> and <code>renderTable()</code>.</p>
<pre class="r"><code>    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 0, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)</code></pre>
<p>This means the calculation of <code>dta</code> is done twice. You always want to avoid this (especially for costly calculations). In these situation we can introduce a <em>reactive conductor</em>, which is executed before the <em>reactive endpoints</em> are calculated. The information propagation graph looks as follows:</p>
<div class="figure">
<img src="https://shiny.rstudio.com/images/reactivity_diagrams/conductor.png" alt="Information propagation graph with one conductor (Source: RStudio)" />
<p class="caption">Information propagation graph with one conductor (Source: <a href="https://shiny.rstudio.com/articles/reactivity-overview.html">RStudio</a>)</p>
</div>
<p>The corresponding <code>server()</code> code is shown in the following:</p>
<pre class="r"><code>server &lt;- function(input, output) {
  # Do the calculations
  dta &lt;- reactive({
    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 0, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
    dta
  })
  
  # Define plot output
  output$noise_plot &lt;- renderPlot({
    # Create and return the plot.
    plot(dta())
  })
  
  # Define table output
  output$noise_table &lt;- renderDataTable({
    # Return the table data.
    dta()
  })
}</code></pre>
<p>Now, variable <code>dta</code> becomes reactive (i.e. a responsive conductor). Note that responsive conductors are followed by <code>()</code> when they are called.</p>
<div id="exercise-3" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Exercise</h3>
<blockquote>
<p>Modify your app, that <code>dta</code> is only calculated once.</p>
</blockquote>
<p>For more information you may want to refer to <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson6/">lesson 6</a> of the RStudio shiny tutorial. For exhaustive information on this topic see <a href="https://shiny.rstudio.com/articles/#reactivity">RStudio’s articles about reactivity</a>.</p>
</div>
</div>
</div>
<div id="debugging" class="section level1">
<h1><span class="header-section-number">3</span> Debugging</h1>
<p>To understand what your app is doing you can and want to apply various debugging techniques. In the following we examine three of them. There is also an RStudio article on <a href="https://shiny.rstudio.com/articles/debugging.html">debugging</a> shiny apps.</p>
<div id="showcase" class="section level2">
<h2><span class="header-section-number">3.1</span> Showcase</h2>
<p>Simple apps can be run in <em>showcase mode</em>. This can help to understand how reactivity works and which part of code is executed under which circumstances. You start your app in the console by typing:</p>
<pre class="r"><code>runApp(&quot;MyApp&quot;, display.mode = &quot;showcase&quot;)</code></pre>
<p>You can find examples of running apps in showcase mode at the RStudio <a href="https://shiny.rstudio.com/gallery/">gallery</a> e.g. in <a href="https://shiny.rstudio.com/gallery/kmeans-example.html">iris k-means clustering</a>.</p>
<div id="exercise-4" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Exercise</h3>
<blockquote>
<p>Introduce <code>radioButtons()</code> in your <code>ui</code> list, which let you choose the color of plotted points. Run your app in showcase mode. Hint: Your <code>plot()</code> should look like that: <code>plot(dta(), col = input$col)</code>.</p>
</blockquote>
</div>
</div>
<div id="reactive-log" class="section level2">
<h2><span class="header-section-number">3.2</span> Reactive Log</h2>
<p>Another way to understand the reactive nature of your app is to examine the <em>reactive log</em> of your app. Basically, with this function you can examine the information propagation graph of your app. To start the reactive log execute</p>
<ul>
<li><code>options(shiny.reactlog=TRUE)</code> in your RStudio console,</li>
<li>start your app by <code>runApp('app.R')</code>,</li>
<li>perform one or two actions in your app, and</li>
<li>hit CTRL+F3 (or for Mac users fn+Command+F3).</li>
</ul>
<p>You then see the reactive log of your app for the actions you just performed.</p>
<div id="exercise-5" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Exercise</h3>
<blockquote>
<p>Just try this with your last app.</p>
</blockquote>
</div>
</div>
<div id="browser" class="section level2">
<h2><span class="header-section-number">3.3</span> <code>browser()</code></h2>
<p>Especially in larger apps and for developing complicated parts of your code which may refer to a certain state of your app, showcase and reactive log are not helpful. In these situation you want to use the <code>browser()</code> function. You can put it anywhere in your R-code. Code execution stops as soon as it passes the <code>browser()</code>. You then can analyse the state of your app, e.g. examine values of variables.</p>
<div id="example" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Example</h3>
<pre class="r"><code>server &lt;- function(input, output) {
  # Do the calculatins
  dta &lt;- reactive({
browser()    
    # Lets make some noise!
    val &lt;- rnorm(n = input$num, mean = 0, sd = 1)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
    dta
  })
  
  ...
}</code></pre>
</div>
<div id="exercise-6" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Exercise</h3>
<blockquote>
<p>Try this and play around.</p>
</blockquote>
<p>Do not forget to remove all <code>browser()</code> calls from your code after debugging!</p>
</div>
</div>
</div>
<div id="dashboards" class="section level1">
<h1><span class="header-section-number">4</span> Dashboards</h1>
<p>As soon as you want to communicate more complex data analyses and allow for users to play around with your data, you need to organize your inputs and outputs in some meaningful way. For this purpose dashboards are used. At the moment there are (at least) two R packages to build dashboards: <a href="http://rmarkdown.rstudio.com/flexdashboard/">flexdashboard</a> and <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a>. In the following a brief overview is given. You will learn more about dashboards later on in the project.</p>
<div id="flexdashboard" class="section level2">
<h2><span class="header-section-number">4.1</span> Flexdashboard</h2>
<p>The <a href="http://rmarkdown.rstudio.com/flexdashboard/shiny.html">flexdashboard</a> package uses <a href="http://rmarkdown.rstudio.com">rmarkdown</a> to structure a dashboard. The advantage of rmarkdown is that is easy to code. The disadvantage is that it is not only R, which means that some things do not work as expected (e.g. debugging with <code>browser()</code>). The flexdashboard package features many interesting layouts. The following is a simple example of a flexdashboard:</p>
<div id="example-1" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Example</h3>
<pre class="r"><code>---
title: &quot;Random Numbers&quot;
runtime: shiny
output:
  flexdashboard::flex_dashboard:
    source: embed
    vertical_layout: fill
---

Plot and Data
=======================================================================

Column {.sidebar}
-----------------------------------------------------------------------

### Controls

This is a sidebar on the left.

``{r}
radioButtons(&quot;col&quot;, h3(&quot;Point Color&quot;),
             choices = list(&quot;Red&quot; = &quot;red&quot;, &quot;Blue&quot; = &quot;blue&quot;),
             selected = &quot;blue&quot;)
sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200)
numericInput(&quot;mean&quot;, h3(&quot;Mean&quot;), value = 0)
numericInput(&quot;sd&quot;, h3(&quot;Standard Deviation&quot;), value = 1)
``

Column {.tabset}
-----------------------------------------------------------------------

### Plot

This is a tab.

``{r}
dta &lt;- reactive({
  val &lt;- rnorm(input$num, input$mean, input$sd)
  num &lt;- seq(1:input$num)
  dta &lt;- dplyr::bind_cols(num = num, val = val)
})

# Define the output
renderPlot({
  # Create the plot.
  plot(dta(), col = input$col)
})
``

### Table

This is another tab.

``{r}
renderDataTable(
  # Return the table data.
  dta(), 
  options = list(pageLength = 10)
)
``

More Information
=======================================================================

This is a new page. Here, you might want to provide further content.</code></pre>
</div>
<div id="exercise-7" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Exercise</h3>
<blockquote>
<p>Create a new .Rmd file inside your RStudio IDE and copy the example code into this file. (<strong>Note, you need to replace <code>``</code> by <code>```</code>!</strong> Otherwise the code is not syntactically correct.) Play around with the dashboard. Later on, it might be the starting point for your own project.</p>
</blockquote>
</div>
</div>
<div id="shinydashboard" class="section level2">
<h2><span class="header-section-number">4.2</span> Shinydashboard</h2>
<p>The <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a> package uses the ‘regular’ shiny approach to structure the dashboard. This might be slightly more complicated than flexdashboard, but it is more flexible and it is R only, which means, everything works as expected. The shinydashboard package provides many features like menus for notifications or messages, boxes to display values, and different styles and layouts.</p>
<p>The basic structure of a shinydashboard looks as follows:</p>
<pre class="r"><code># Telling, the ui, that this is a dashboard page.
ui &lt;- dashboardPage(
  # First define the dashboard header.
  dashboardHeader(title = &quot;Shiny dashboard&quot;),
  # Second define the sidebar of the dashboard.
  dashboardSidebar(
    # Inside the sidebar you might want to place a menue ...
    sidebarMenu(
      menuItem(&quot;Title Item1&quot;, tabName = &quot;item1&quot;),
      menuItem(&quot;Title Item2&quot;, tabName = &quot;item2&quot;)
    ),
    # ... or some input elements.
    sliderInput(&quot;input1&quot;, &quot;Title Input2&quot;, min = 1, max = 10),
    numericInput(&quot;input2&quot;, &quot;Title Input1&quot;, value = 0),
  ),
  # Third the body of the dashboard is defined.
  dashboardBody(
    # Inside the body you list all the tabs. 
    tabItems(
      # Tab items are referenced by the menu items. 
      tabItem(tabName = &quot;item1&quot;,
        # The structure inside the tab is similar to ordinary Shiny apps.
        fluidRow(
          # Everything which is to be shown is wrapped in boxes.
          box(),
          box()
        )
      ),
      # The second tab item.
      tabItem(tabName = &quot;item2&quot;,
        fluidRow(
          box()
        )
      )
    )
  )
)</code></pre>
<p>Note, the structure of the shinydashboard only affects the <code>ui</code> list. The server remains the same as in a regular shiny app. Examine the following working example:</p>
<div id="example-2" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Example</h3>
<pre class="r"><code>library(shinydashboard)

ui &lt;- dashboardPage(
  dashboardHeader(title = &quot;Shiny dashboard&quot;),
  dashboardSidebar(
    sidebarMenu(
      menuItem(&quot;Plot&quot;, tabName = &quot;plot_item&quot;, icon = icon(&quot;area-chart&quot;)),
      menuItem(&quot;Data&quot;, tabName = &quot;table_item&quot;, icon = icon(&quot;table&quot;)),
      menuItem(&quot;More&quot;, tabName = &quot;more_item&quot;, icon = icon(&quot;plus-square&quot;))
    ),
    sliderInput(&quot;num&quot;, &quot;Number of Values&quot;, min = 10, max = 500, value = 200),
    numericInput(&quot;mean&quot;, &quot;Mean&quot;, value = 0),
    numericInput(&quot;sd&quot;, &quot;Standard Deviation&quot;, value = 1)
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = &quot;plot_item&quot;,
        # The structure inside the tab is similar to ordinary Shiny apps
        fluidRow(
          box(width = 8, plotOutput(&quot;plot&quot;, height = 250)),
          box(
            width = 4,
            title = &quot;Controls&quot;,
            radioButtons(&quot;col&quot;, &quot;Point Color&quot;,
                         choices = list(&quot;Red&quot; = &quot;red&quot;, &quot;Blue&quot; = &quot;blue&quot;),
                         selected = &quot;blue&quot;)
          )
        )
      ),
      tabItem(tabName = &quot;table_item&quot;,
        # The structure inside the tab is similar to ordinary Shiny apps
        fluidRow(
          box(width = 12, dataTableOutput(&quot;table&quot;))
        )
      ),
      tabItem(tabName = &quot;more_item&quot;,
        # The structure inside the tab is similar to ordinary Shiny apps
        fluidRow(
          &quot;More content.&quot;
        )
      )
    )
  )
)

server &lt;- function(input, output) {
  # Generate data reactively
  dta &lt;- reactive({
    val &lt;- rnorm(input$num, input$mean, input$sd)
    num &lt;- seq(1:input$num)
    dta &lt;- dplyr::bind_cols(num = num, val = val)
  })
  
  # Define the outputs
  output$plot &lt;- renderPlot({
    # Create the plot.
    plot(dta(), col = input$col)
  })
  
  output$table &lt;- renderDataTable(
    # Return the table data.
    dta(), 
    options = list(pageLength = 10)
  )
}

shinyApp(ui, server, options = list(height = 700))</code></pre>
<div class="figure">
<img src="img/img6.png" />

</div>
</div>
<div id="exercise-8" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Exercise</h3>
<blockquote>
<p>Create a new R file inside your RStudio IDE and copy the example code into this file. Play around with the dashboard. Later on, it might be the starting point for your own project.</p>
</blockquote>
</div>
</div>
</div>
<div id="project" class="section level1">
<h1><span class="header-section-number">5</span> Project</h1>
<div id="next-steps" class="section level2">
<h2><span class="header-section-number">5.1</span> Next Steps</h2>
<p>Now, we have done a brute force ride through features of Shiny. Now, you can choose one out of three options for your next steps in this workshop. The aim is to deepen and extend your understanding of Shiny. The three options are:</p>
<ol style="list-style-type: decimal">
<li><p>You are pretty new to R and or programming and want to understand the basics more in depth: Take the <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/">RStudio Shiny Tutorial</a> and read <a href="https://shiny.rstudio.com/articles/">other articles</a> about Shiny. This is high quality material, but if you need support, you will get it here.</p></li>
<li><p>You got the basic idea of Shiny and want to know more about dashboards: Go on with one of the example dashboards. You can read about this in the following.</p></li>
<li><p>You are pretty confident that you are able to develop your own dashboard: Go on with this and take the first steps towards your own app. Take one of the examples above or one of the two working dashboards below as a starting point. You will get as much support as possible.</p></li>
</ol>
</div>
<div id="a-shiny-weather-dashboard" class="section level2">
<h2><span class="header-section-number">5.2</span> A Shiny Weather Dashboard</h2>
<p>This dashboard allows to compare the forecast data from different providers and assess its reliability.</p>
<div id="data" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Data</h3>
<p>As toy example we will create an app which shows weather forecast data from four web sites for further analyses:</p>
<ul>
<li><a href="http://www.wetter.com">wetter.com</a>, which provides weather data e.g. for <a href="http://www.spiegel.de">Spiegel Online</a>;</li>
<li><a href="http://www.wetter.de">wetter.de</a>;</li>
<li><a href="https://weather.com">weather.com</a>, which provides (among others) data for the Apple weather app;</li>
<li><a href="http://www.wetterkontor.de">wetterkontor.de</a>, which provides weather data e.g. for Bild.de.</li>
</ul>
<p>The data is scraped from these web sites using <a href="https://github.com/hadley/rvest">rvest</a> and <a href="https://cran.r-project.org/web/packages/RSelenium/">RSelenium</a>. Scraping happens on a daily basis and is not part of the dashboard.</p>
</div>
<div id="dashboard-structure" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Dashboard structure</h3>
<p>The dashboard comes in two versions: as <a href="http://rmarkdown.rstudio.com/flexdashboard/">flexdashboard</a> and as <a href="http://rstudio.github.io/shinydashboard/">shinydashboard</a>. Both dashboards use modules to encapsulate different parts of the app. To access the data we will use a R6-class. You will learn about modules and R6 classes first and then go on with one of the two dashboards. Apart from the modules both dashboards are structured according to what you have learned above.</p>
</div>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Exercises</h3>
<blockquote>
<p>A good way to learn is to work with and extend existing code.</p>
<ol style="list-style-type: decimal">
<li>If you decide to work on the Shiny Weather dashboard</li>
</ol>
<ul>
<li>you can download the latest data from <a href="https://www.dropbox.com/s/nohq6vgyfb43y1o/dta.zip?dl=0">Dropbox</a>.</li>
<li>As a starting point you can get the <a href="download/MetaWeather_FlexDashb-2017-10-13.tar.gz">bundle</a> of the flexdashboard.</li>
<li>A <a href="download/MetaWeather_ShinyDashb-2017-10-13.tar.gz">bundle</a> of the Shiny Weather shinydashboard is available as well.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Get your version of the Dashboard locally running and play around.<br />
</li>
<li>Add a new tab to the dashboard which displays a table showing all the data.</li>
<li>Add further tabs for further views on the data (e.g. you might want to show weather history)</li>
<li>All the data is loaded at once when the dashboard is started. Change the code, so that only data is loaded which is really needed at start-up time. Introduce a button to trigger loading the rest of the data.</li>
<li>You might want to improve the plots, add other types of plots, add more details to the map, introduce more inputs to increase interactivity. Go ahead! Try to keep the structure given and extend it.</li>
</ol>
</blockquote>
</div>
</div>
</div>
<div id="advanced-techniques" class="section level1">
<h1><span class="header-section-number">6</span> Advanced techniques</h1>
<p>There are two further techniques used in the Shiny Weather dashboards, which are briefly described in the following.</p>
<div id="modules" class="section level2">
<h2><span class="header-section-number">6.1</span> Modules</h2>
<p>Modules are a good way to manage complex application code. They can be seen as independent building blocks of your dashboard or application. They consist of an <code>ui</code> part and a <code>server</code> part, both defined in a single file. You can find a good <a href="https://shiny.rstudio.com/articles/modules.html">introduction into using modules</a> on the RStudio website. An example showing the basic structure of a module is given in the <a href="http://shiny.rstudio.com/gallery/module-example.html">RStudio gallary</a>.</p>
<p>The two Shiny Weather dashboards use the same modules. I.e. the modules are just plugged into different dashboard frameworks.</p>
</div>
<div id="r6-classes" class="section level2">
<h2><span class="header-section-number">6.2</span> R6-classes</h2>
<p>R6-classes allow for the object-oriented programming paradigm and are easier to understand than the other types of R classes. Classes in general help to encapsulate and structure code in larger code bases. In the Shiny Weather dashboard a R6-class is used to encapsulate data processing.</p>
<p>For a comprehensive introduction on R6 classes there is a <a href="https://cran.r-project.org/web/packages/R6/vignettes/Introduction.html">vignette of the package</a>. The following example shows the basic structure of a R6-class.</p>
<div id="example-3" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Example</h3>
<pre class="r"><code>library(R6)

Animal &lt;- R6Class(&quot;Person&quot;,
  # List of public class memders. This can be variables or functions.
  # Public members are accessible form the outside of the class.
  public = list(
    name = NULL,
    species = NULL,
    
    # This function is called everytime a new object of this 
    # class is instanziated.
    initialize = function(name = NA, species = NA, legs = NA) {
      
      # Set variables of the class.
      self$name &lt;- name
      self$species &lt;- species
      private$number_of_legs &lt;- legs
      
      # Call private function of the class.
      private$say_hi()
    },
    
    # Define a public function.
    set_legs = function(legs) {
      private$number_of_legs &lt;- legs
      private$say_hi(again = TRUE)
    }
  ),
  # List of private members, which are only accessible from inside the class. 
  private = list(
    # Definition of a private variable.
    number_of_legs = NULL,
    
    # Define a private function.
    say_hi = function(again = FALSE) {
      if (!again) {
        cat(paste0(&quot;Hi, I am &quot;, self$name, &quot;, the &quot;, 
                   private$number_of_legs, &quot;-leged &quot;, self$species, &quot;.\n&quot;))
      } else {
        cat(paste0(&quot;Hi, now I am &quot;, self$name, &quot;, the &quot;, 
                   private$number_of_legs, &quot;-leged &quot;, self$species, &quot;.\n&quot;))
      }
    }
  )
)</code></pre>
<p>The shown R6-class can be used as follows.</p>
<pre class="r"><code># Instantiate an object of class Animal
animal_sam &lt;- Animal$new(&quot;Sam&quot;, &quot;dog&quot;, &quot;4&quot;)</code></pre>
<pre><code>## Hi, I am Sam, the 4-leged dog.</code></pre>
<pre class="r"><code># Call a public function of that class
animal_sam$set_legs(3)</code></pre>
<pre><code>## Hi, now I am Sam, the 3-leged dog.</code></pre>
<pre class="r"><code># Public member variables are also accessible
animal_sam$name</code></pre>
<pre><code>## [1] &quot;Sam&quot;</code></pre>
</div>
</div>
</div>
<div id="links" class="section level1">
<h1><span class="header-section-number">7</span> Links</h1>
<p>Some links to helpful resources:</p>
<ul>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">Cheetsheets</a></li>
<li><a href="https://shiny.rstudio.com">RStudio</a></li>
<li><a href="https://shiny.rstudio.com">Shiny</a></li>
<li><a href="http://rmarkdown.rstudio.com">Rmarkdown</a></li>
<li><a href="http://rmarkdown.rstudio.com/flexdashboard/">Flexdashboard</a></li>
<li><a href="https://rstudio.github.io/shinydashboard/">Shinydashboard</a></li>
<li><a href="http://jkunst.com/highcharter/index.html">Highcharter</a></li>
<li><a href="https://www.rstudio.com/products/rpackages/">Some more of the most helpfull packages for data science</a></li>
</ul>
</div>

<hr>
<p>Copyright &copy; 2016 stenze &nbsp;&nbsp;
<i class="fa fa-envelope" aria-hidden="true"></i> Contact: s at skek dot de</p>
<p><a href="imprint.html">Impressum (German)</a></p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
